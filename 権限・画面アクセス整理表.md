# システム権限・画面アクセス整理表

---

## 📋 **権限ロール定義**

| ロールID | ロール名 | 説明 | 対象ユーザー |
|----------|----------|------|-------------|
| `executive_admin` | 経営管理者 | 全システム管理権限 | 経営陣、システム管理者 |
| `sales_admin` | 営業管理 | 営業・案件管理権限 | 営業マネージャー、営業リーダー |
| `accounting` | 経理 | 経理関連設定・請求管理 | 経理担当者、会計担当者 |

---

## 🎯 **設定画面アクセス権限（実装済み）**

| 設定画面 | 経営管理者 | 営業管理 | 経理 | 備考 |
|----------|-----------|----------|------|------|
| **ユーザー情報設定** | ✅ | ✅ | ✅ | 自分のプロフィール設定 |
| **スタッフ管理** | ✅ | ✅ | ❌ | スタッフの追加・編集・削除 |
| **2次店管理** | ✅ | ✅ | ❌ | 2次請け会社の管理 |
| **代理店・イベント管理** | ✅ | ✅ | ❌ | 代理店・イベント場所マスタ |
| **経理管理** | ✅ | ❌ | ✅ | 請求・支払い・テンプレート設定 |
| **システムユーザー管理** | ✅ | ❌ | ❌ | システム利用者・権限管理 |

---

## 📊 **業務画面アクセス権限（今後実装予定）**

### **主要業務画面一覧**

| 業務画面カテゴリ | 主な機能 |
|-----------------|----------|
| **案件管理** | 案件の検索・一覧表示・詳細管理・ステータス管理・履歴管理 |
| **シフト管理** | スタッフのシフト作成・編集・案件への割り当て・会場への人員配置 |
| **経理業務** | 請求書・見積書の作成・編集・送付管理・金額確認・承認 |
| **通知機能** | システム通知の管理・確認・対応 |

---

## 🔐 **権限レベル定義**

各画面での操作権限を以下の2レベルで分類：

| 権限レベル | 説明 | 操作例 |
|-----------|------|--------|
| **参照** | データの閲覧のみ可能 | 一覧表示、詳細確認、検索、フィルタ |
| **管理** | データの作成・更新・削除が可能 | 新規作成、情報変更、ステータス更新、削除、システム設定変更 |

---

## 📋 **業務画面別権限マトリックス（提案）**

| 業務カテゴリ | 経営管理者 | 営業管理 | 経理 | 検討ポイント |
|-------------|-----------|----------|------|-------------|
| **案件管理** | 管理 | 管理 | 参照 | 経理は請求処理時の案件情報確認が必要 |
| **シフト管理** | 管理 | 管理 | ❌ | 経理は直接関与しない？人件費計算で必要？ |
| **経理業務** | 管理 | 参照 | 管理 | 営業は状況確認のみ？見積作成は営業も関与？ |
| **通知機能** | 管理 | 管理 | 管理 | 全員が通知を確認・対応 |

---

## ❓ **検討が必要な項目**

### **1. 経理ロールのシフト管理アクセス**
- **現状**: シフト管理への権限なし
- **検討点**: 
  - 請求処理で勤務実績の確認が必要な場合があるか？
  - 人件費計算でシフト情報が必要か？
- **提案**: 最低限「参照」権限は付与を検討

### **2. 営業管理の経理業務権限**
- **現状**: 経理管理画面へのアクセスなし
- **検討点**:
  - 営業が見積書を直接作成するか？
  - 請求状況を営業が確認する必要があるか？
  - 案件から請求への連携で営業の関与は必要か？
- **提案**: 見積作成は「管理」、請求関連は「参照」を検討

### **3. データの部門間連携**
- **検討点**:
  - 営業が作成した案件を経理が請求処理する際の情報連携
  - 承認フローが必要な処理の洗い出し
  - 部門間でのデータ整合性チェック

### **4. 権限の細分化**
- **検討点**:
  - 「管理」権限をさらに細分化するか？
    - 新規作成のみ
    - 既存データの更新のみ
    - 特定フィールドのみ編集可能
  - 金額に関わる項目の特別な権限管理

---

## 🎯 **次のステップ**

1. **業務フロー確認**: 実際の業務の流れに沿って権限設計を検証
2. **承認フロー定義**: どの処理に承認が必要かを明確化
3. **例外ケース整理**: 緊急時や特別な状況での権限変更ルール
4. **段階的実装計画**: 優先度の高い画面から権限制御を実装

---

## 📝 **実装時の技術的考慮事項**

- **フロントエンド**: 画面表示・ボタン制御での権限チェック
- **バックエンド**: API レベルでの権限検証（セキュリティ確保）
- **監査ログ**: 権限を使った操作の記録・追跡
- **権限変更**: 運用中の権限変更時の影響範囲確認

---

*この整理表は現在の実装状況と想定される業務フローを基に作成しています。*  
*実際の運用に合わせて権限設計の調整が必要です。*
